<html lang="en" class="scroll-smooth" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trie Str</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
  <div id="app" class="flex-grow flex flex-col max-w-5xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-6">
    <header class="mb-6">
      <h1 class="text-3xl font-bold text-center text-gray-900">Trie Str</h1>
    </header>

    <!-- Tabs -->
    <nav class="flex justify-center space-x-8 border-b border-gray-300 mb-6">
      <button
        id="tab-produk"
        class="tab-button border-b-2 border-indigo-600 text-indigo-600 font-semibold pb-2"
        aria-selected="true"
        aria-controls="panel-produk"
        role="tab"
        tabindex="0"
      >
        Produk
      </button>
      <button
        id="tab-benefit"
        class="tab-button border-b-2 border-transparent text-gray-600 hover:text-indigo-600 pb-2"
        aria-selected="false"
        aria-controls="panel-benefit"
        role="tab"
        tabindex="-1"
      >
        Benefit
      </button>
    </nav>

    <!-- Tab Panels -->
    <section
      id="panel-produk"
      role="tabpanel"
      aria-labelledby="tab-produk"
      tabindex="0"
      class="tab-panel"
    >
      <div id="catalogs-container" class="space-y-4">
        <!-- Catalogs will be rendered here -->
      </div>
    </section>

    <section
      id="panel-benefit"
      role="tabpanel"
      aria-labelledby="tab-benefit"
      tabindex="0"
      class="tab-panel hidden"
    >
      <div id="benefits-container" class="space-y-4 max-w-3xl mx-auto">
        <!-- Benefits buttons will be rendered here -->
      </div>
    </section>

    <!-- Admin Login Modal -->
    <div
      id="admin-login-modal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="admin-login-title"
    >
      <div class="bg-white rounded-lg shadow-lg p-6 w-80 max-w-full">
        <h2 id="admin-login-title" class="text-xl font-semibold mb-4 text-center">Admin Login</h2>
        <form id="admin-login-form" class="space-y-4">
          <label for="pin-input" class="block text-gray-700 font-medium">Enter PIN</label>
          <input
            id="pin-input"
            type="password"
            inputmode="numeric"
            pattern="[0-9]*"
            maxlength="8"
            autocomplete="off"
            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
            required
          />
          <div class="flex justify-end space-x-2">
            <button
              type="button"
              id="admin-login-cancel"
              class="px-4 py-2 rounded border border-gray-300 hover:bg-gray-100"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700"
            >
              Login
            </button>
          </div>
        </form>
        <p id="admin-login-error" class="text-red-600 mt-2 text-center hidden">Incorrect PIN</p>
      </div>
    </div>

    <!-- Admin Panel Modal -->
    <div
      id="admin-panel-modal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden overflow-auto"
      role="dialog"
      aria-modal="true"
      aria-labelledby="admin-panel-title"
    >
      <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
          <h2 id="admin-panel-title" class="text-2xl font-semibold">Admin Panel</h2>
          <button
            id="admin-panel-close"
            aria-label="Close admin panel"
            class="text-gray-600 hover:text-gray-900 text-2xl font-bold"
          >
            &times;
          </button>
        </div>

        <div class="space-y-8">
          <!-- Catalogs Management -->
          <section>
            <h3 class="text-xl font-semibold mb-3 border-b border-gray-300 pb-1">Catalogs</h3>
            <div id="admin-catalogs-list" class="space-y-4 max-h-72 overflow-y-auto border border-gray-200 rounded p-3 bg-gray-50">
              <!-- Catalog edit forms here -->
            </div>
            <button
              id="admin-add-catalog"
              class="mt-3 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
              type="button"
            >
              + Add Catalog
            </button>
          </section>

          <!-- Products Management -->
          <section>
            <h3 class="text-xl font-semibold mb-3 border-b border-gray-300 pb-1">Products</h3>
            <div id="admin-products-list" class="space-y-4 max-h-72 overflow-y-auto border border-gray-200 rounded p-3 bg-gray-50">
              <!-- Product edit forms here -->
            </div>
            <button
              id="admin-add-product"
              class="mt-3 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
              type="button"
            >
              + Add Product
            </button>
          </section>

          <!-- Benefits Management -->
          <section>
            <h3 class="text-xl font-semibold mb-3 border-b border-gray-300 pb-1">Benefits</h3>
            <div id="admin-benefits-list" class="space-y-4 max-h-72 overflow-y-auto border border-gray-200 rounded p-3 bg-gray-50">
              <!-- Benefit edit forms here -->
            </div>
            <button
              id="admin-add-benefit"
              class="mt-3 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
              type="button"
            >
              + Add Benefit
            </button>
          </section>
        </div>
      </div>
    </div>

    <!-- Benefit Popup Modal -->
    <div
      id="benefit-popup-modal"
      class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden p-4"
      role="dialog"
      aria-modal="true"
      aria-labelledby="benefit-popup-title"
    >
      <div class="bg-white rounded-lg shadow-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto flex flex-col">
        <button
          id="benefit-popup-close"
          aria-label="Close benefit popup"
          class="self-end m-2 text-gray-600 hover:text-gray-900 text-3xl font-bold"
        >
          &times;
        </button>
        <div class="p-4 flex flex-col space-y-4">
          <video
            id="benefit-popup-video"
            controls
            class="w-full max-h-96 rounded"
            preload="metadata"
          >
            <source src="" type="video/mp4" />
            Your browser does not support the video tag.
          </video>
          <div id="benefit-popup-text" class="text-gray-800 text-lg"></div>
        </div>
      </div>
    </div>

    <!-- Admin Login Button -->
    <button
      id="admin-login-button"
      class="fixed bottom-6 right-6 bg-indigo-600 text-white rounded-full p-4 shadow-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
      aria-label="Open admin login"
      title="Admin Login"
      type="button"
    >
      <i class="fas fa-user-cog fa-lg"></i>
    </button>
  </div>

  <script>
    (() => {
      // Data keys for localStorage
      const STORAGE_KEY = 'trieStrData';

      // Default data if no data in localStorage
      const defaultData = {
        catalogs: [
          {
            id: 'catalog-1',
            name: 'Catalog A',
            productIds: ['product-1', 'product-2', 'product-3'],
          },
          {
            id: 'catalog-2',
            name: 'Catalog B',
            productIds: ['product-4', 'product-5', 'product-6'],
          },
          {
            id: 'catalog-3',
            name: 'Catalog C',
            productIds: ['product-7', 'product-8', 'product-9'],
          },
        ],
        products: [
          { id: 'product-1', name: 'Produk A1', price: 150000, catalogId: 'catalog-1' },
          { id: 'product-2', name: 'Produk A2', price: 250000, catalogId: 'catalog-1' },
          { id: 'product-3', name: 'Produk A3', price: 350000, catalogId: 'catalog-1' },

          { id: 'product-4', name: 'Produk B1', price: 120000, catalogId: 'catalog-2' },
          { id: 'product-5', name: 'Produk B2', price: 220000, catalogId: 'catalog-2' },
          { id: 'product-6', name: 'Produk B3', price: 320000, catalogId: 'catalog-2' },

          { id: 'product-7', name: 'Produk C1', price: 180000, catalogId: 'catalog-3' },
          { id: 'product-8', name: 'Produk C2', price: 280000, catalogId: 'catalog-3' },
          { id: 'product-9', name: 'Produk C3', price: 380000, catalogId: 'catalog-3' },
        ],
        benefits: [
          {
            id: 'benefit-1',
            name: 'Benefit 1',
            videoUrl: 'https://placehold.co/video/640x360/mp4?text=Benefit+1+Video',
            text: 'Ini adalah penjelasan benefit 1 yang sangat bermanfaat untuk produk kami.',
          },
          {
            id: 'benefit-2',
            name: 'Benefit 2',
            videoUrl: 'https://placehold.co/video/640x360/mp4?text=Benefit+2+Video',
            text: 'Benefit 2 memberikan keunggulan tambahan yang tidak dimiliki produk lain.',
          },
          {
            id: 'benefit-3',
            name: 'Benefit 3',
            videoUrl: 'https://placehold.co/video/640x360/mp4?text=Benefit+3+Video',
            text: 'Dengan Benefit 3, Anda akan mendapatkan pengalaman terbaik dan maksimal.',
          },
        ],
      };

      // Load data from localStorage or default
      function loadData() {
        try {
          const stored = localStorage.getItem(STORAGE_KEY);
          if (stored) {
            return JSON.parse(stored);
          }
        } catch {
          // ignore parse errors
        }
        return JSON.parse(JSON.stringify(defaultData));
      }

      // Save data to localStorage
      function saveData(data) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      }

      // Format price to IDR currency format
      function formatPrice(price) {
        return new Intl.NumberFormat('id-ID', {
          style: 'currency',
          currency: 'IDR',
          minimumFractionDigits: 0,
        }).format(price);
      }

      // Elements
      const tabButtons = document.querySelectorAll('.tab-button');
      const panelProduk = document.getElementById('panel-produk');
      const panelBenefit = document.getElementById('panel-benefit');
      const catalogsContainer = document.getElementById('catalogs-container');
      const benefitsContainer = document.getElementById('benefits-container');
      const adminLoginModal = document.getElementById('admin-login-modal');
      const adminLoginForm = document.getElementById('admin-login-form');
      const pinInput = document.getElementById('pin-input');
      const adminLoginError = document.getElementById('admin-login-error');
      const adminLoginButton = document.getElementById('admin-login-button');
      const adminLoginCancel = document.getElementById('admin-login-cancel');
      const adminPanelModal = document.getElementById('admin-panel-modal');
      const adminPanelClose = document.getElementById('admin-panel-close');
      const adminCatalogsList = document.getElementById('admin-catalogs-list');
      const adminAddCatalogBtn = document.getElementById('admin-add-catalog');
      const adminProductsList = document.getElementById('admin-products-list');
      const adminAddProductBtn = document.getElementById('admin-add-product');
      const adminBenefitsList = document.getElementById('admin-benefits-list');
      const adminAddBenefitBtn = document.getElementById('admin-add-benefit');
      const benefitPopupModal = document.getElementById('benefit-popup-modal');
      const benefitPopupClose = document.getElementById('benefit-popup-close');
      const benefitPopupVideo = document.getElementById('benefit-popup-video');
      const benefitPopupText = document.getElementById('benefit-popup-text');

      // Current data
      let data = loadData();

      // Current tab state
      let currentTab = 'produk';

      // Admin PIN
      const ADMIN_PIN = '19191923';

      // Utility: generate unique id
      function generateId(prefix) {
        return prefix + '-' + Math.random().toString(36).slice(2, 10);
      }

      // Render catalogs with collapsible product lists
      function renderCatalogs() {
        catalogsContainer.innerHTML = '';
        data.catalogs.forEach((catalog) => {
          const catalogDiv = document.createElement('div');
          catalogDiv.className = 'border border-gray-300 rounded bg-white shadow-sm';

          // Header button to toggle
          const headerBtn = document.createElement('button');
          headerBtn.type = 'button';
          headerBtn.className =
            'w-full flex justify-between items-center px-4 py-3 text-left font-semibold text-indigo-700 hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-500';
          headerBtn.setAttribute('aria-expanded', 'false');
          headerBtn.setAttribute('aria-controls', `${catalog.id}-products`);
          headerBtn.id = `${catalog.id}-header`;
          headerBtn.textContent = catalog.name;

          const iconSpan = document.createElement('span');
          iconSpan.className = 'transform transition-transform duration-300';
          iconSpan.innerHTML = '<i class="fas fa-chevron-down"></i>';
          headerBtn.appendChild(iconSpan);

          // Products container (collapsible)
          const productsDiv = document.createElement('div');
          productsDiv.id = `${catalog.id}-products`;
          productsDiv.className = 'px-6 py-4 space-y-4 hidden';
          productsDiv.setAttribute('aria-labelledby', `${catalog.id}-header`);

          // Filter products for this catalog
          const products = data.products.filter((p) => p.catalogId === catalog.id);

          products.forEach((product) => {
            const productDiv = document.createElement('div');
            productDiv.className = 'flex flex-col sm:flex-row sm:items-center sm:justify-between bg-gray-50 rounded p-3 shadow-inner';

            // Product info
            const infoDiv = document.createElement('div');
            infoDiv.className = 'mb-2 sm:mb-0';

            const productName = document.createElement('p');
            productName.className = 'font-semibold text-gray-900';
            productName.textContent = product.name;

            const productPrice = document.createElement('p');
            productPrice.className = 'text-indigo-600 font-semibold';
            productPrice.textContent = formatPrice(product.price);

            infoDiv.appendChild(productName);
            infoDiv.appendChild(productPrice);

            // Buttons container
            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'flex space-x-3';

            // See Benefit button
            const seeBenefitBtn = document.createElement('button');
            seeBenefitBtn.type = 'button';
            seeBenefitBtn.className =
              'px-3 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500';
            seeBenefitBtn.textContent = 'See Benefit';
            seeBenefitBtn.addEventListener('click', () => {
              switchTab('benefit');
            });

            // Cart button with cart icon
            const cartBtn = document.createElement('button');
            cartBtn.type = 'button';
            cartBtn.className =
              'px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center justify-center';
            cartBtn.title = `Add ${product.name} to cart (WhatsApp)`;
            cartBtn.setAttribute('aria-label', `Add ${product.name} to cart (WhatsApp)`);

            const cartIcon = document.createElement('i');
            cartIcon.className = 'fas fa-shopping-cart';
            cartBtn.appendChild(cartIcon);

            cartBtn.addEventListener('click', () => {
              const encodedText = encodeURIComponent(`bang beli ${product.name} dong`);
              const waUrl = `https://wa.me/6283857797304?text=${encodedText}`;
              window.open(waUrl, '_blank', 'noopener');
            });

            buttonsDiv.appendChild(seeBenefitBtn);
            buttonsDiv.appendChild(cartBtn);

            productDiv.appendChild(infoDiv);
            productDiv.appendChild(buttonsDiv);

            productsDiv.appendChild(productDiv);
          });

          // Toggle function
          headerBtn.addEventListener('click', () => {
            const expanded = headerBtn.getAttribute('aria-expanded') === 'true';
            headerBtn.setAttribute('aria-expanded', String(!expanded));
            if (expanded) {
              productsDiv.classList.add('hidden');
              iconSpan.style.transform = 'rotate(0deg)';
            } else {
              productsDiv.classList.remove('hidden');
              iconSpan.style.transform = 'rotate(180deg)';
            }
          });

          catalogDiv.appendChild(headerBtn);
          catalogDiv.appendChild(productsDiv);
          catalogsContainer.appendChild(catalogDiv);
        });
      }

      // Render benefits buttons
      function renderBenefits() {
        benefitsContainer.innerHTML = '';
        data.benefits.forEach((benefit) => {
          const btn = document.createElement('button');
          btn.type = 'button';
          btn.className =
            'w-full text-left px-4 py-3 bg-white rounded shadow hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-semibold text-indigo-700';
          btn.textContent = benefit.name;
          btn.addEventListener('click', () => {
            openBenefitPopup(benefit);
          });
          benefitsContainer.appendChild(btn);
        });
      }

      // Open benefit popup modal
      function openBenefitPopup(benefit) {
        benefitPopupVideo.src = benefit.videoUrl;
        benefitPopupText.textContent = benefit.text;
        benefitPopupModal.classList.remove('hidden');
        benefitPopupVideo.focus();
      }

      // Close benefit popup modal
      function closeBenefitPopup() {
        benefitPopupVideo.pause();
        benefitPopupVideo.src = '';
        benefitPopupText.textContent = '';
        benefitPopupModal.classList.add('hidden');
      }

      // Switch tab function
      function switchTab(tabName) {
        currentTab = tabName;
        if (tabName === 'produk') {
          panelProduk.classList.remove('hidden');
          panelBenefit.classList.add('hidden');
          tabButtons.forEach((btn) => {
            if (btn.id === 'tab-produk') {
              btn.classList.add('border-indigo-600', 'text-indigo-600', 'font-semibold');
              btn.classList.remove('border-transparent', 'text-gray-600');
              btn.setAttribute('aria-selected', 'true');
              btn.tabIndex = 0;
            } else {
              btn.classList.remove('border-indigo-600', 'text-indigo-600', 'font-semibold');
              btn.classList.add('border-transparent', 'text-gray-600');
              btn.setAttribute('aria-selected', 'false');
              btn.tabIndex = -1;
            }
          });
          panelProduk.focus();
        } else if (tabName === 'benefit') {
          panelBenefit.classList.remove('hidden');
          panelProduk.classList.add('hidden');
          tabButtons.forEach((btn) => {
            if (btn.id === 'tab-benefit') {
              btn.classList.add('border-indigo-600', 'text-indigo-600', 'font-semibold');
              btn.classList.remove('border-transparent', 'text-gray-600');
              btn.setAttribute('aria-selected', 'true');
              btn.tabIndex = 0;
            } else {
              btn.classList.remove('border-indigo-600', 'text-indigo-600', 'font-semibold');
              btn.classList.add('border-transparent', 'text-gray-600');
              btn.setAttribute('aria-selected', 'false');
              btn.tabIndex = -1;
            }
          });
          panelBenefit.focus();
        }
      }

      // Render admin catalogs list
      function renderAdminCatalogs() {
        adminCatalogsList.innerHTML = '';
        data.catalogs.forEach((catalog) => {
          const div = document.createElement('div');
          div.className = 'border border-gray-300 rounded p-3 bg-white flex flex-col space-y-2';

          // Catalog name input
          const nameLabel = document.createElement('label');
          nameLabel.textContent = 'Catalog Name';
          nameLabel.className = 'font-semibold text-gray-700';
          const nameInput = document.createElement('input');
          nameInput.type = 'text';
          nameInput.value = catalog.name;
          nameInput.className =
            'w-full border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500';
          nameInput.addEventListener('input', (e) => {
            catalog.name = e.target.value;
            saveData(data);
            renderCatalogs();
          });

          // Delete catalog button
          const deleteBtn = document.createElement('button');
          deleteBtn.type = 'button';
          deleteBtn.className =
            'self-start px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500';
          deleteBtn.textContent = 'Delete Catalog';
          deleteBtn.addEventListener('click', () => {
            // Remove catalog and all its products
            data.products = data.products.filter((p) => p.catalogId !== catalog.id);
            data.catalogs = data.catalogs.filter((c) => c.id !== catalog.id);
            saveData(data);
            renderCatalogs();
            renderAdminCatalogs();
            renderAdminProducts();
          });

          div.appendChild(nameLabel);
          div.appendChild(nameInput);
          div.appendChild(deleteBtn);

          adminCatalogsList.appendChild(div);
        });
      }

      // Render admin products list
      function renderAdminProducts() {
        adminProductsList.innerHTML = '';
        data.products.forEach((product) => {
          const div = document.createElement('div');
          div.className = 'border border-gray-300 rounded p-3 bg-white flex flex-col space-y-2';

          // Product name input
          const nameLabel = document.createElement('label');
          nameLabel.textContent = 'Product Name';
          nameLabel.className = 'font-semibold text-gray-700';
          const nameInput = document.createElement('input');
          nameInput.type = 'text';
          nameInput.value = product.name;
          nameInput.className =
            'w-full border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500';
          nameInput.addEventListener('input', (e) => {
            product.name = e.target.value;
            saveData(data);
            renderCatalogs();
          });

          // Product price input
          const priceLabel = document.createElement('label');
          priceLabel.textContent = 'Price (IDR)';
          priceLabel.className = 'font-semibold text-gray-700';
          const priceInput = document.createElement('input');
          priceInput.type = 'number';
          priceInput.min = '0';
          priceInput.value = product.price;
          priceInput.className =
            'w-full border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500';
          priceInput.addEventListener('input', (e) => {
            const val = parseInt(e.target.value, 10);
            if (!isNaN(val) && val >= 0) {
              product.price = val;
              saveData(data);
              renderCatalogs();
            }
          });

          // Catalog select
          const catalogLabel = document.createElement('label');
          catalogLabel.textContent = 'Catalog';
          catalogLabel.className = 'font-semibold text-gray-700';
          const catalogSelect = document.createElement('select');
          catalogSelect.className =
            'w-full border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500';
          data.catalogs.forEach((catalog) => {
            const option = document.createElement('option');
            option.value = catalog.id;
            option.textContent = catalog.name;
            if (catalog.id === product.catalogId) option.selected = true;
            catalogSelect.appendChild(option);
          });
          catalogSelect.addEventListener('change', (e) => {
            product.catalogId = e.target.value;
            saveData(data);
            renderCatalogs();
          });

          // Delete product button
          const deleteBtn = document.createElement('button');
          deleteBtn.type = 'button';
          deleteBtn.className =
            'self-start px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500';
          deleteBtn.textContent = 'Delete Product';
          deleteBtn.addEventListener('click', () => {
            data.products = data.products.filter((p) => p.id !== product.id);
            saveData(data);
            renderCatalogs();
            renderAdminProducts();
          });

          div.appendChild(nameLabel);
          div.appendChild(nameInput);
          div.appendChild(priceLabel);
          div.appendChild(priceInput);
          div.appendChild(catalogLabel);
          div.appendChild(catalogSelect);
          div.appendChild(deleteBtn);

          adminProductsList.appendChild(div);
        });
      }

      // Render admin benefits list
      function renderAdminBenefits() {
        adminBenefitsList.innerHTML = '';
        data.benefits.forEach((benefit) => {
          const div = document.createElement('div');
          div.className = 'border border-gray-300 rounded p-3 bg-white flex flex-col space-y-2';

          // Benefit name input
          const nameLabel = document.createElement('label');
          nameLabel.textContent = 'Benefit Name';
          nameLabel.className = 'font-semibold text-gray-700';
          const nameInput = document.createElement('input');
          nameInput.type = 'text';
          nameInput.value = benefit.name;
          nameInput.className =
            'w-full border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500';
          nameInput.addEventListener('input', (e) => {
            benefit.name = e.target.value;
            saveData(data);
            renderBenefits();
          });

          // Video URL input
          const videoLabel = document.createElement('label');
          videoLabel.textContent = 'Video URL (MP4)';
          videoLabel.className = 'font-semibold text-gray-700';
          const videoInput = document.createElement('input');
          videoInput.type = 'url';
          videoInput.value = benefit.videoUrl;
          videoInput.className =
            'w-full border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500';
          videoInput.addEventListener('input', (e) => {
            benefit.videoUrl = e.target.value;
            saveData(data);
          });

          // Benefit text textarea
          const textLabel = document.createElement('label');
          textLabel.textContent = 'Benefit Text';
          textLabel.className = 'font-semibold text-gray-700';
          const textArea = document.createElement('textarea');
          textArea.value = benefit.text;
          textArea.rows = 3;
          textArea.className =
            'w-full border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-y';
          textArea.addEventListener('input', (e) => {
            benefit.text = e.target.value;
            saveData(data);
          });

          // Delete benefit button
          const deleteBtn = document.createElement('button');
          deleteBtn.type = 'button';
          deleteBtn.className =
            'self-start px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500';
          deleteBtn.textContent = 'Delete Benefit';
          deleteBtn.addEventListener('click', () => {
            data.benefits = data.benefits.filter((b) => b.id !== benefit.id);
            saveData(data);
            renderBenefits();
            renderAdminBenefits();
          });

          div.appendChild(nameLabel);
          div.appendChild(nameInput);
          div.appendChild(videoLabel);
          div.appendChild(videoInput);
          div.appendChild(textLabel);
          div.appendChild(textArea);
          div.appendChild(deleteBtn);

          adminBenefitsList.appendChild(div);
        });
      }

      // Add new catalog
      function addCatalog() {
        const newCatalog = {
          id: generateId('catalog'),
          name: 'New Catalog',
          productIds: [],
        };
        data.catalogs.push(newCatalog);
        saveData(data);
        renderCatalogs();
        renderAdminCatalogs();
      }

      // Add new product
      function addProduct() {
        if (data.catalogs.length === 0) {
          alert('Please add a catalog first before adding products.');
          return;
        }
        const newProduct = {
          id: generateId('product'),
          name: 'New Product',
          price: 0,
          catalogId: data.catalogs[0].id,
        };
        data.products.push(newProduct);
        saveData(data);
        renderCatalogs();
        renderAdminProducts();
      }

      // Add new benefit
      function addBenefit() {
        const newBenefit = {
          id: generateId('benefit'),
          name: 'New Benefit',
          videoUrl: '',
          text: '',
        };
        data.benefits.push(newBenefit);
        saveData(data);
        renderBenefits();
        renderAdminBenefits();
      }

      // Open admin login modal
      function openAdminLogin() {
        pinInput.value = '';
        adminLoginError.classList.add('hidden');
        adminLoginModal.classList.remove('hidden');
        pinInput.focus();
      }

      // Close admin login modal
      function closeAdminLogin() {
        adminLoginModal.classList.add('hidden');
      }

      // Open admin panel modal
      function openAdminPanel() {
        renderAdminCatalogs();
        renderAdminProducts();
        renderAdminBenefits();
        adminPanelModal.classList.remove('hidden');
      }

      // Close admin panel modal
      function closeAdminPanel() {
        adminPanelModal.classList.add('hidden');
      }

      // Event listeners for tabs
      tabButtons.forEach((btn) => {
        btn.addEventListener('click', () => {
          if (btn.id === 'tab-produk') {
            switchTab('produk');
          } else if (btn.id === 'tab-benefit') {
            switchTab('benefit');
          }
        });
      });

      // Benefit popup close
      benefitPopupClose.addEventListener('click', closeBenefitPopup);
      benefitPopupModal.addEventListener('click', (e) => {
        if (e.target === benefitPopupModal) {
          closeBenefitPopup();
        }
      });

      // Admin login button open
      adminLoginButton.addEventListener('click', openAdminLogin);

      // Admin login cancel button
      adminLoginCancel.addEventListener('click', closeAdminLogin);

      // Admin login form submit
      adminLoginForm.addEventListener('submit', (e) => {
        e.preventDefault();
        if (pinInput.value === ADMIN_PIN) {
          closeAdminLogin();
          openAdminPanel();
        } else {
          adminLoginError.classList.remove('hidden');
          pinInput.focus();
        }
      });

      // Admin panel close button
      adminPanelClose.addEventListener('click', closeAdminPanel);

      // Add catalog button
      adminAddCatalogBtn.addEventListener('click', addCatalog);

      // Add product button
      adminAddProductBtn.addEventListener('click', addProduct);

      // Add benefit button
      adminAddBenefitBtn.addEventListener('click', addBenefit);

      // Close benefit popup on Escape key
      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (!benefitPopupModal.classList.contains('hidden')) {
            closeBenefitPopup();
          }
          if (!adminLoginModal.classList.contains('hidden')) {
            closeAdminLogin();
          }
          if (!adminPanelModal.classList.contains('hidden')) {
            closeAdminPanel();
          }
        }
      });

      // Initial render
      renderCatalogs();
      renderBenefits();
      switchTab('produk');
    })();
  </script>
</body>
</html>
