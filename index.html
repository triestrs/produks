<html lang="en" class="scroll-smooth" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trie Str</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
  <div id="app" class="flex-grow flex flex-col max-w-4xl mx-auto w-full px-4 py-6">
    <header class="mb-6 flex justify-between items-center border-b border-gray-300 pb-3">
      <h1 class="text-3xl font-bold text-indigo-700 select-none">Trie Str</h1>
      <button
        id="adminLoginBtn"
        class="text-indigo-600 hover:text-indigo-800 font-semibold focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded"
        aria-label="Admin Login"
      >
        Admin Login
      </button>
    </header>

    <!-- Tabs -->
    <nav class="mb-6 border-b border-gray-300">
      <ul class="flex space-x-6 text-lg font-semibold text-gray-600" role="tablist">
        <li>
          <button
            id="tabProduk"
            role="tab"
            aria-selected="true"
            aria-controls="panelProduk"
            tabindex="0"
            class="pb-2 border-b-4 border-indigo-600 text-indigo-700 focus:outline-none"
          >
            Produk
          </button>
        </li>
        <li>
          <button
            id="tabBenefit"
            role="tab"
            aria-selected="false"
            aria-controls="panelBenefit"
            tabindex="-1"
            class="pb-2 border-b-4 border-transparent hover:border-indigo-400 text-gray-600 hover:text-indigo-600 focus:outline-none"
          >
            Benefit
          </button>
        </li>
      </ul>
    </nav>

    <!-- Tab Panels -->
    <section id="panelProduk" role="tabpanel" tabindex="0" aria-labelledby="tabProduk" class="block">
      <div id="catalogsContainer" class="space-y-6">
        <!-- Catalogs will be rendered here -->
      </div>
    </section>

    <section id="panelBenefit" role="tabpanel" tabindex="0" aria-labelledby="tabBenefit" class="hidden">
      <div id="benefitsContainer" class="space-y-6 max-w-3xl mx-auto">
        <!-- Benefits will be rendered here -->
      </div>
    </section>
  </div>

  <!-- Popup for Benefit Video + Text -->
  <div
    id="benefitPopup"
    class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="popupTitle"
  >
    <div class="bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-lg relative">
      <button
        id="popupCloseBtn"
        class="absolute top-3 right-3 text-gray-600 hover:text-gray-900 focus:outline-none"
        aria-label="Close popup"
      >
        <i class="fas fa-times fa-lg"></i>
      </button>
      <div class="p-4 flex flex-col space-y-4">
        <video
          id="popupVideo"
          controls
          class="w-full rounded-md max-h-96 object-contain"
          aria-describedby="popupText"
        >
          <source src="" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
        <p id="popupText" class="text-gray-800 text-base"></p>
      </div>
    </div>
  </div>

  <!-- Admin Login Modal -->
  <div
    id="adminLoginModal"
    class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="adminLoginTitle"
  >
    <div class="bg-white rounded-lg max-w-md w-full shadow-lg p-6 relative">
      <button
        id="adminLoginCloseBtn"
        class="absolute top-3 right-3 text-gray-600 hover:text-gray-900 focus:outline-none"
        aria-label="Close admin login"
      >
        <i class="fas fa-times fa-lg"></i>
      </button>
      <h2 id="adminLoginTitle" class="text-xl font-semibold mb-4 text-indigo-700">Admin Login</h2>
      <form id="adminLoginForm" class="flex flex-col space-y-4" autocomplete="off">
        <label for="adminPassword" class="font-medium text-gray-700">Password</label>
        <input
          id="adminPassword"
          type="password"
          required
          class="border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          aria-describedby="passwordHelp"
          autocomplete="new-password"
        />
        <p id="passwordHelp" class="text-sm text-red-600 hidden">Password salah</p>
        <button
          type="submit"
          class="bg-indigo-600 text-white rounded py-2 font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
        >
          Login
        </button>
      </form>
    </div>
  </div>

  <!-- Admin Panel Modal -->
  <div
    id="adminPanelModal"
    class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="adminPanelTitle"
  >
    <div class="bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto shadow-lg p-6 relative flex flex-col">
      <button
        id="adminPanelCloseBtn"
        class="absolute top-3 right-3 text-gray-600 hover:text-gray-900 focus:outline-none"
        aria-label="Close admin panel"
      >
        <i class="fas fa-times fa-lg"></i>
      </button>
      <h2 id="adminPanelTitle" class="text-2xl font-bold mb-4 text-indigo-700">Admin Panel</h2>

      <div class="flex flex-col md:flex-row gap-6">
        <!-- Left: Catalogs & Products -->
        <div class="flex-1 border border-gray-300 rounded p-4 max-h-[70vh] overflow-y-auto">
          <h3 class="text-lg font-semibold mb-3 text-indigo-600">Catalogs & Products</h3>
          <div id="adminCatalogsList" class="space-y-4">
            <!-- Catalogs with products editable -->
          </div>
          <button
            id="addCatalogBtn"
            class="mt-4 w-full bg-indigo-600 text-white rounded py-2 font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          >
            + Add Catalog
          </button>
        </div>

        <!-- Right: Benefits -->
        <div class="flex-1 border border-gray-300 rounded p-4 max-h-[70vh] overflow-y-auto">
          <h3 class="text-lg font-semibold mb-3 text-indigo-600">Benefits</h3>
          <div id="adminBenefitsList" class="space-y-4">
            <!-- Benefits editable -->
          </div>
          <button
            id="addBenefitBtn"
            class="mt-4 w-full bg-indigo-600 text-white rounded py-2 font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          >
            + Add Benefit
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    (() => {
      // Data structure for catalogs, products, benefits
      // Load from localStorage or default data
      const STORAGE_KEY = "trieStrData";

      const defaultData = {
        catalogs: [
          {
            id: crypto.randomUUID(),
            name: "Sc No Up (Via Tele)",
            open: false,
            products: [
              {
                id: crypto.randomUUID(),
                name: "Sc Xyroo Aphocalips",
                price: 20000,
              },
              {
                id: crypto.randomUUID(),
                name: "Sc Lunox",
                price: 10000,
              },
            ],
          },
          {
            id: crypto.randomUUID(),
            name: "Sc Full Up (Via tele)",
            open: false,
            products: [
              {
                id: crypto.randomUUID(),
                name: "Sc Xyroo Aphocalips",
                price: 30000,
              },
              {
                id: crypto.randomUUID(),
                name: "Sc Lunox",
                price: 15000,
              },
            ],
          },
        ],
        benefits: [
          {
            id: crypto.randomUUID(),
            name: "Benefit 1",
            video:
              "https://placehold.co/600x400?text=Benefit+1+Video+Placeholder.mp4",
            text: "Ini adalah penjelasan benefit pertama yang sangat bermanfaat untuk pengguna.",
          },
          {
            id: crypto.randomUUID(),
            name: "Benefit 2",
            video:
              "https://placehold.co/600x400?text=Benefit+2+Video+Placeholder.mp4",
            text: "Benefit kedua memberikan keuntungan tambahan yang tidak kalah penting.",
          },
        ],
      };

      let data = JSON.parse(localStorage.getItem(STORAGE_KEY)) || defaultData;

      // Elements
      const tabProdukBtn = document.getElementById("tabProduk");
      const tabBenefitBtn = document.getElementById("tabBenefit");
      const panelProduk = document.getElementById("panelProduk");
      const panelBenefit = document.getElementById("panelBenefit");
      const catalogsContainer = document.getElementById("catalogsContainer");
      const benefitsContainer = document.getElementById("benefitsContainer");
      const benefitPopup = document.getElementById("benefitPopup");
      const popupCloseBtn = document.getElementById("popupCloseBtn");
      const popupVideo = document.getElementById("popupVideo");
      const popupText = document.getElementById("popupText");

      const adminLoginBtn = document.getElementById("adminLoginBtn");
      const adminLoginModal = document.getElementById("adminLoginModal");
      const adminLoginCloseBtn = document.getElementById("adminLoginCloseBtn");
      const adminLoginForm = document.getElementById("adminLoginForm");
      const adminPasswordInput = document.getElementById("adminPassword");
      const passwordHelp = document.getElementById("passwordHelp");

      const adminPanelModal = document.getElementById("adminPanelModal");
      const adminPanelCloseBtn = document.getElementById("adminPanelCloseBtn");
      const adminCatalogsList = document.getElementById("adminCatalogsList");
      const adminBenefitsList = document.getElementById("adminBenefitsList");
      const addCatalogBtn = document.getElementById("addCatalogBtn");
      const addBenefitBtn = document.getElementById("addBenefitBtn");

      // Password for admin
      const ADMIN_PASSWORD = "ArinsJaya@1";

      // Utility: format price to IDR
      function formatPrice(price) {
        return new Intl.NumberFormat("id-ID", {
          style: "currency",
          currency: "IDR",
          minimumFractionDigits: 0,
        }).format(price);
      }

      // Render catalogs and products in Produk tab
      function renderCatalogs() {
        catalogsContainer.innerHTML = "";
        data.catalogs.forEach((catalog, cIndex) => {
          const catalogDiv = document.createElement("div");
          catalogDiv.className = "border border-gray-300 rounded shadow-sm bg-white";

          // Catalog header (click to toggle open)
          const headerBtn = document.createElement("button");
          headerBtn.type = "button";
          headerBtn.className =
            "w-full flex justify-between items-center px-4 py-3 text-left font-semibold text-indigo-700 hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-500";
          headerBtn.setAttribute("aria-expanded", catalog.open);
          headerBtn.setAttribute("aria-controls", `catalog-products-${catalog.id}`);
          headerBtn.id = `catalog-header-${catalog.id}`;
          headerBtn.textContent = catalog.name;

          const iconSpan = document.createElement("span");
          iconSpan.className = "ml-2 text-indigo-600";
          iconSpan.innerHTML = catalog.open
            ? '<i class="fas fa-chevron-up"></i>'
            : '<i class="fas fa-chevron-down"></i>';
          headerBtn.appendChild(iconSpan);

          headerBtn.addEventListener("click", () => {
            catalog.open = !catalog.open;
            saveData();
            renderCatalogs();
          });

          catalogDiv.appendChild(headerBtn);

          // Products container
          const productsDiv = document.createElement("div");
          productsDiv.id = `catalog-products-${catalog.id}`;
          productsDiv.className = catalog.open ? "block px-4 py-3 space-y-4" : "hidden";

          catalog.products.forEach((product) => {
            const productDiv = document.createElement("div");
            productDiv.className =
              "flex flex-col sm:flex-row sm:items-center sm:justify-between border border-gray-200 rounded p-3 bg-gray-50";

            // Product info
            const infoDiv = document.createElement("div");
            infoDiv.className = "mb-2 sm:mb-0";

            const productName = document.createElement("p");
            productName.className = "font-semibold text-gray-800";
            productName.textContent = product.name;

            const productPrice = document.createElement("p");
            productPrice.className = "text-indigo-700 font-semibold";
            productPrice.textContent = formatPrice(product.price);

            infoDiv.appendChild(productName);
            infoDiv.appendChild(productPrice);

            // Buttons container
            const buttonsDiv = document.createElement("div");
            buttonsDiv.className = "flex space-x-3";

            // See Benefit button
            const seeBenefitBtn = document.createElement("button");
            seeBenefitBtn.type = "button";
            seeBenefitBtn.className =
              "bg-indigo-600 text-white px-4 py-1 rounded hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-semibold";
            seeBenefitBtn.textContent = "See Benefit";
            seeBenefitBtn.addEventListener("click", () => {
              switchTab("benefit");
            });

            // Cart button with cart icon
            const cartBtn = document.createElement("button");
            cartBtn.type = "button";
            cartBtn.className =
              "bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center space-x-2";
            cartBtn.setAttribute("aria-label", `Add ${product.name} to cart`);
            const cartIcon = document.createElement("i");
            cartIcon.className = "fas fa-shopping-cart";
            cartBtn.appendChild(cartIcon);

            cartBtn.addEventListener("click", () => {
              const encodedProductName = encodeURIComponent(product.name);
              const waLink = `https://wa.me/6283857797304?text=bang+beli+${encodedProductName}+dong`;
              window.open(waLink, "_blank", "noopener");
            });

            buttonsDiv.appendChild(seeBenefitBtn);
            buttonsDiv.appendChild(cartBtn);

            productDiv.appendChild(infoDiv);
            productDiv.appendChild(buttonsDiv);

            productsDiv.appendChild(productDiv);
          });

          catalogDiv.appendChild(productsDiv);
          catalogsContainer.appendChild(catalogDiv);
        });
      }

      // Render benefits tab
      function renderBenefits() {
        benefitsContainer.innerHTML = "";
        data.benefits.forEach((benefit) => {
          const benefitBtn = document.createElement("button");
          benefitBtn.type = "button";
          benefitBtn.className =
            "w-full bg-indigo-600 text-white py-3 rounded font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500";
          benefitBtn.textContent = benefit.name;

          benefitBtn.addEventListener("click", () => {
            openBenefitPopup(benefit);
          });

          benefitsContainer.appendChild(benefitBtn);
        });
      }

      // Open benefit popup with video + text
      function openBenefitPopup(benefit) {
        popupVideo.src = benefit.video;
        popupText.textContent = benefit.text;
        benefitPopup.classList.remove("hidden");
        popupVideo.focus();
      }

      // Close benefit popup
      function closeBenefitPopup() {
        benefitPopup.classList.add("hidden");
        popupVideo.pause();
        popupVideo.src = "";
      }

      // Switch tabs
      function switchTab(tabName) {
        if (tabName === "produk") {
          tabProdukBtn.setAttribute("aria-selected", "true");
          tabProdukBtn.classList.add("border-indigo-600", "text-indigo-700");
          tabProdukBtn.classList.remove("border-transparent", "text-gray-600", "hover:border-indigo-400", "hover:text-indigo-600");

          tabBenefitBtn.setAttribute("aria-selected", "false");
          tabBenefitBtn.classList.remove("border-indigo-600", "text-indigo-700");
          tabBenefitBtn.classList.add("border-transparent", "text-gray-600", "hover:border-indigo-400", "hover:text-indigo-600");

          panelProduk.classList.remove("hidden");
          panelProduk.classList.add("block");
          panelBenefit.classList.add("hidden");
          panelBenefit.classList.remove("block");
          panelProduk.focus();
        } else if (tabName === "benefit") {
          tabProdukBtn.setAttribute("aria-selected", "false");
          tabProdukBtn.classList.remove("border-indigo-600", "text-indigo-700");
          tabProdukBtn.classList.add("border-transparent", "text-gray-600", "hover:border-indigo-400", "hover:text-indigo-600");

          tabBenefitBtn.setAttribute("aria-selected", "true");
          tabBenefitBtn.classList.add("border-indigo-600", "text-indigo-700");
          tabBenefitBtn.classList.remove("border-transparent", "text-gray-600", "hover:border-indigo-400", "hover:text-indigo-600");

          panelProduk.classList.add("hidden");
          panelProduk.classList.remove("block");
          panelBenefit.classList.remove("hidden");
          panelBenefit.classList.add("block");
          panelBenefit.focus();
        }
      }

      // Save data to localStorage
      function saveData() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      }

      // Admin login modal open/close
      adminLoginBtn.addEventListener("click", () => {
        adminLoginModal.classList.remove("hidden");
        adminPasswordInput.value = "";
        passwordHelp.classList.add("hidden");
        adminPasswordInput.focus();
      });

      adminLoginCloseBtn.addEventListener("click", () => {
        adminLoginModal.classList.add("hidden");
      });

      adminLoginForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const pw = adminPasswordInput.value;
        if (pw === ADMIN_PASSWORD) {
          adminLoginModal.classList.add("hidden");
          openAdminPanel();
        } else {
          passwordHelp.classList.remove("hidden");
          adminPasswordInput.focus();
        }
      });

      // Admin panel open/close
      adminPanelCloseBtn.addEventListener("click", () => {
        adminPanelModal.classList.add("hidden");
      });

      // Render admin catalogs & products editable
      function renderAdminCatalogs() {
        adminCatalogsList.innerHTML = "";
        data.catalogs.forEach((catalog, cIndex) => {
          const catalogDiv = document.createElement("div");
          catalogDiv.className = "border border-gray-300 rounded p-3 bg-gray-50";

          // Catalog name input + delete catalog button
          const catalogHeaderDiv = document.createElement("div");
          catalogHeaderDiv.className = "flex items-center justify-between mb-2";

          const catalogNameInput = document.createElement("input");
          catalogNameInput.type = "text";
          catalogNameInput.value = catalog.name;
          catalogNameInput.className =
            "border border-gray-300 rounded px-2 py-1 w-full focus:outline-none focus:ring-2 focus:ring-indigo-500";
          catalogNameInput.setAttribute("aria-label", `Edit catalog name ${catalog.name}`);
          catalogNameInput.addEventListener("input", (e) => {
            catalog.name = e.target.value;
            saveData();
            renderCatalogs();
          });

          const deleteCatalogBtn = document.createElement("button");
          deleteCatalogBtn.type = "button";
          deleteCatalogBtn.className =
            "ml-2 text-red-600 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 rounded px-2 py-1 font-semibold";
          deleteCatalogBtn.textContent = "Delete";
          deleteCatalogBtn.addEventListener("click", () => {
            if (
              confirm(
                `Are you sure you want to delete catalog "${catalog.name}" and all its products?`
              )
            ) {
              data.catalogs.splice(cIndex, 1);
              saveData();
              renderCatalogs();
              renderAdminCatalogs();
            }
          });

          catalogHeaderDiv.appendChild(catalogNameInput);
          catalogHeaderDiv.appendChild(deleteCatalogBtn);
          catalogDiv.appendChild(catalogHeaderDiv);

          // Products list
          const productsListDiv = document.createElement("div");
          productsListDiv.className = "space-y-2";

          catalog.products.forEach((product, pIndex) => {
            const productDiv = document.createElement("div");
            productDiv.className = "flex items-center space-x-2";

            const productNameInput = document.createElement("input");
            productNameInput.type = "text";
            productNameInput.value = product.name;
            productNameInput.className =
              "border border-gray-300 rounded px-2 py-1 flex-1 focus:outline-none focus:ring-2 focus:ring-indigo-500";
            productNameInput.setAttribute("aria-label", `Edit product name ${product.name}`);
            productNameInput.addEventListener("input", (e) => {
              product.name = e.target.value;
              saveData();
              renderCatalogs();
            });

            const productPriceInput = document.createElement("input");
            productPriceInput.type = "number";
            productPriceInput.min = "0";
            productPriceInput.value = product.price;
            productPriceInput.className =
              "border border-gray-300 rounded px-2 py-1 w-28 focus:outline-none focus:ring-2 focus:ring-indigo-500";
            productPriceInput.setAttribute("aria-label", `Edit price for product ${product.name}`);
            productPriceInput.addEventListener("input", (e) => {
              const val = parseInt(e.target.value);
              if (!isNaN(val) && val >= 0) {
                product.price = val;
                saveData();
                renderCatalogs();
              }
            });

            const deleteProductBtn = document.createElement("button");
            deleteProductBtn.type = "button";
            deleteProductBtn.className =
              "text-red-600 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 rounded px-2 py-1 font-semibold";
            deleteProductBtn.textContent = "Delete";
            deleteProductBtn.addEventListener("click", () => {
              if (
                confirm(
                  `Are you sure you want to delete product "${product.name}"?`
                )
              ) {
                catalog.products.splice(pIndex, 1);
                saveData();
                renderCatalogs();
                renderAdminCatalogs();
              }
            });

            productDiv.appendChild(productNameInput);
            productDiv.appendChild(productPriceInput);
            productDiv.appendChild(deleteProductBtn);

            productsListDiv.appendChild(productDiv);
          });

          // Add product button
          const addProductBtn = document.createElement("button");
          addProductBtn.type = "button";
          addProductBtn.className =
            "mt-2 w-full bg-indigo-600 text-white rounded py-1 font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500";
          addProductBtn.textContent = "+ Add Product";
          addProductBtn.addEventListener("click", () => {
            catalog.products.push({
              id: crypto.randomUUID(),
              name: "Produk Baru",
              price: 0,
            });
            saveData();
            renderCatalogs();
            renderAdminCatalogs();
          });

          catalogDiv.appendChild(productsListDiv);
          catalogDiv.appendChild(addProductBtn);

          adminCatalogsList.appendChild(catalogDiv);
        });
      }

      // Render admin benefits editable
      function renderAdminBenefits() {
        adminBenefitsList.innerHTML = "";
        data.benefits.forEach((benefit, bIndex) => {
          const benefitDiv = document.createElement("div");
          benefitDiv.className = "border border-gray-300 rounded p-3 bg-gray-50";

          // Benefit name input + delete button
          const benefitHeaderDiv = document.createElement("div");
          benefitHeaderDiv.className = "flex items-center justify-between mb-2";

          const benefitNameInput = document.createElement("input");
          benefitNameInput.type = "text";
          benefitNameInput.value = benefit.name;
          benefitNameInput.className =
            "border border-gray-300 rounded px-2 py-1 w-full focus:outline-none focus:ring-2 focus:ring-indigo-500";
          benefitNameInput.setAttribute("aria-label", `Edit benefit name ${benefit.name}`);
          benefitNameInput.addEventListener("input", (e) => {
            benefit.name = e.target.value;
            saveData();
            renderBenefits();
          });

          const deleteBenefitBtn = document.createElement("button");
          deleteBenefitBtn.type = "button";
          deleteBenefitBtn.className =
            "ml-2 text-red-600 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 rounded px-2 py-1 font-semibold";
          deleteBenefitBtn.textContent = "Delete";
          deleteBenefitBtn.addEventListener("click", () => {
            if (
              confirm(
                `Are you sure you want to delete benefit "${benefit.name}"?`
              )
            ) {
              data.benefits.splice(bIndex, 1);
              saveData();
              renderBenefits();
              renderAdminBenefits();
            }
          });

          benefitHeaderDiv.appendChild(benefitNameInput);
          benefitHeaderDiv.appendChild(deleteBenefitBtn);
          benefitDiv.appendChild(benefitHeaderDiv);

          // Video URL input
          const videoInput = document.createElement("input");
          videoInput.type = "text";
          videoInput.value = benefit.video;
          videoInput.className =
            "border border-gray-300 rounded px-2 py-1 w-full mb-2 focus:outline-none focus:ring-2 focus:ring-indigo-500";
          videoInput.setAttribute("aria-label", `Edit video URL for benefit ${benefit.name}`);
          videoInput.placeholder = "Video URL (mp4)";
          videoInput.addEventListener("input", (e) => {
            benefit.video = e.target.value;
            saveData();
          });

          // Textarea for benefit text
          const textArea = document.createElement("textarea");
          textArea.value = benefit.text;
          textArea.className =
            "border border-gray-300 rounded px-2 py-1 w-full resize-y focus:outline-none focus:ring-2 focus:ring-indigo-500";
          textArea.setAttribute("aria-label", `Edit text for benefit ${benefit.name}`);
          textArea.rows = 3;
          textArea.placeholder = "Benefit description text";
          textArea.addEventListener("input", (e) => {
            benefit.text = e.target.value;
            saveData();
          });

          benefitDiv.appendChild(videoInput);
          benefitDiv.appendChild(textArea);

          adminBenefitsList.appendChild(benefitDiv);
        });
      }

      // Open admin panel and render data
      function openAdminPanel() {
        renderAdminCatalogs();
        renderAdminBenefits();
        adminPanelModal.classList.remove("hidden");
      }

      // Event listeners for tabs
      tabProdukBtn.addEventListener("click", () => switchTab("produk"));
      tabBenefitBtn.addEventListener("click", () => switchTab("benefit"));

      // Benefit popup close
      popupCloseBtn.addEventListener("click", closeBenefitPopup);
      benefitPopup.addEventListener("click", (e) => {
        if (e.target === benefitPopup) {
          closeBenefitPopup();
        }
      });

      // Add catalog button in admin panel
      addCatalogBtn.addEventListener("click", () => {
        data.catalogs.push({
          id: crypto.randomUUID(),
          name: "Catalog Baru",
          open: false,
          products: [],
        });
        saveData();
        renderCatalogs();
        renderAdminCatalogs();
      });

      // Add benefit button in admin panel
      addBenefitBtn.addEventListener("click", () => {
        data.benefits.push({
          id: crypto.randomUUID(),
          name: "Benefit Baru",
          video: "",
          text: "",
        });
        saveData();
        renderBenefits();
        renderAdminBenefits();
      });

      // Initial render
      renderCatalogs();
      renderBenefits();
      switchTab("produk");

      // Accessibility: trap focus inside modals when open
      function trapFocus(element) {
        const focusableElementsString =
          'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]';
        const focusableElements = element.querySelectorAll(focusableElementsString);
        if (focusableElements.length === 0) return;

        const firstFocusable = focusableElements[0];
        const lastFocusable = focusableElements[focusableElements.length - 1];

        function handleTrap(e) {
          if (e.key === "Tab") {
            if (e.shiftKey) {
              if (document.activeElement === firstFocusable) {
                e.preventDefault();
                lastFocusable.focus();
              }
            } else {
              if (document.activeElement === lastFocusable) {
                e.preventDefault();
                firstFocusable.focus();
              }
            }
          }
          if (e.key === "Escape") {
            if (element === adminLoginModal) {
              adminLoginModal.classList.add("hidden");
            } else if (element === adminPanelModal) {
              adminPanelModal.classList.add("hidden");
            } else if (element === benefitPopup) {
              closeBenefitPopup();
            }
          }
        }

        element.addEventListener("keydown", handleTrap);
      }

      trapFocus(adminLoginModal);
      trapFocus(adminPanelModal);
      trapFocus(benefitPopup);
    })();
  </script>
</body>
</html>
